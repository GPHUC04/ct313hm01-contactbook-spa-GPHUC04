import{_ as x,e as I,h as b,i as p,j as L,u as S,c,k as n,f as i,l as B,t as h,a as m,n as D,o,m as l}from"./index-CC7uckQd.js";import{C as E}from"./ContactForm-Ifo_F8wH.js";const F={key:0,class:"page"},M={key:0},q={key:1,class:"alert alert-warning"},N={key:3,class:"alert alert-info mt-3"},R={key:1,class:"text-center"},U={__name:"ContactEdit",props:{contactId:{type:String,required:!0}},setup(k){const a=k,s=S();D();const e=I(""),f=["contact",a.contactId],{data:u,isLoading:y,error:d}=b({queryKey:f,queryFn:()=>l().fetchContact(a.contactId),enabled:!!a.contactId}),_=p({mutationFn:t=>l().deleteContact(t),onSuccess:()=>{e.value="Liên hệ đã được xóa.",s.push({name:"contactbook"})},onError:t=>{e.value="Có lỗi xảy ra khi xóa liên hệ.",console.error("Delete error:",t)}}),v=p({mutationFn:t=>l().updateContact(a.contactId,t),onSuccess:()=>{e.value="Liên hệ được cập nhật thành công.",setTimeout(()=>s.push({name:"contactbook"}),2e3)},onError:t=>{e.value="Có lỗi xảy ra khi cập nhật liên hệ.",console.error("Update error:",t)}});function C(t){confirm("Bạn muốn xóa Liên hệ này?")&&_.mutate(t)}function g(t){v.mutate(t)}return L(()=>{/^\d+$/.test(a.contactId)||(e.value="ID liên hệ không hợp lệ.",s.push({name:"notfound"}))}),(t,r)=>n(y)?(o(),c("div",R,r[1]||(r[1]=[m("div",{class:"spinner-border text-primary",role:"status"},[m("span",{class:"visually-hidden"},"Đang tải...")],-1)]))):(o(),c("div",F,[n(u)?(o(),c("h4",M,"Hiệu chỉnh Liên hệ")):i("",!0),n(d)?(o(),c("p",q,h(n(d).message||"Liên hệ không tồn tại."),1)):i("",!0),n(u)?(o(),B(E,{key:2,contact:n(u),"is-add-mode":!1,"onSave:contact":g,"onDelete:contact":C,"onCancel:contact":r[0]||(r[0]=()=>n(s).push({name:"contactbook"}))},null,8,["contact"])):i("",!0),e.value?(o(),c("p",N,h(e.value),1)):i("",!0)]))}},w=x(U,[["__scopeId","data-v-ba765b4c"]]);export{w as default};
